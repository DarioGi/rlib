dnl Configure template for RLIB

dnl Copyright (c) 2003 SICOM Systems Inc (bdoan@sicompos.com)
dnl RLIB is free software; you can redistribute it and/or modify
dnl it under the terms of the GNU General Public License as published by
dnl the Free Software Foundation; either version 2, or (at your option)
dnl any later version.

dnl RLIB is distributed in the hope that it will be useful,
dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
dnl GNU General Public License for more details.

dnl You should have received a copy of the GNU General Public License
dnl along with this program; if not, write to the Free Software
dnl Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
dnl 02111-1307, USA.

dnl Report bugs to rlib-devel@lists.sourceforge.net
dnl
dnl Process this file with autoconf to produce a configure script.

AC_INIT(libsrc/rlib.h)
AM_INIT_AUTOMAKE(rlib, 1.1.1)
AM_INIT_AUTOMAKE(libr, 1.1.1)
AM_MAINTAINER_MODE
AC_DISABLE_STATIC


RLIB_MAJOR_VERSION=1
RLIB_MINOR_VERSION=1
RLIB_MICRO_VERSION=1
RLIB_VERSION=$RLIB_MAJOR_VERSION.$RLIB_MINOR_VERSION.$RLIB_MICRO_VERSION
LIBR_VERSION=$RLIB_MAJOR_VERSION.$RLIB_MINOR_VERSION.$RLIB_MICRO_VERSION
RLIB_VERSION_INFO=`expr $RLIB_MAJOR_VERSION + $RLIB_MINOR_VERSION`:$RLIB_MICRO_VERSION:$RLIB_MINOR_VERSION

RLIB_VERSION_NUMBER=`expr $RLIB_MAJOR_VERSION \* 10000 + $RLIB_MINOR_VERSION \* 100 + $RLIB_MICRO_VERSION`

AC_SUBST(RLIB_MAJOR_VERSION)
AC_SUBST(RLIB_MINOR_VERSION)
AC_SUBST(RLIB_MICRO_VERSION)
AC_SUBST(RLIB_VERSION)
AC_SUBST(LIBR_VERSION)
AC_SUBST(RLIB_VERSION_INFO)
AC_SUBST(RLIB_VERSION_NUMBER)

VERSION=${RLIB_VERSION}


dnl Checks for programs.
AC_PROG_CC
AC_PROG_MAKE_SET
AC_PROG_INSTALL
AM_PROG_LIBTOOL

dnl Checks for libraries.
AC_CHECK_LIB(c, exit)
AC_CHECK_LIB(m, exp)

AC_PATH_PROG(PKG_CONFIG, pkg-config, no)

PKG_CHECK_MODULES(LIBXML, libxml-2.0 >= 2.4.0)
AC_SUBST(LIBXML_LIBS)
AC_SUBST(LIBXML_CFLAGS)

AC_PATH_PROG(MYSQL_CONFIG, mysql_config, no)
MYSQL_CFLAGS=`$MYSQL_CONFIG --cflags`
MYSQL_LIBS=`$MYSQL_CONFIG --libs`
AC_SUBST(MYSQL_CFLAGS)
AC_SUBST(MYSQL_LIBS)

AC_PATH_PROG(PHP_CONFIG, php-config, no)
PHP_CFLAGS=`$PHP_CONFIG --includes`
PHP_EXTENSTION_DIR=`$PHP_CONFIG --extension-dir`
AC_SUBST(PHP_CFLAGS)
AC_SUBST(PHP_EXTENSTION_DIR)

AC_PATH_PROG(POSTGRE_CONFIG, pg_config, no)
POSTGRE_CFLAGS="-I `$POSTGRE_CONFIG --includedir`"
POSTGRE_LIBS="-L`$POSTGRE_CONFIG --libdir` -lpgeasy"
AC_SUBST(POSTGRE_CFLAGS)
AC_SUBST(POSTGRE_LIBS)


PHP_PREFIX_DEFAULT=`php-config --extension-dir`
AC_SUBST(PHP_PREFIX_DEFAULT)

echo "*****************************************************************"
echo " RLIB IS GOING TO INSTALL PHP EXT IN $PHP_EXTENSTION_DIR "
echo " THIS WAS PICKED UP FROM $PHP_CONFIG "
echo " MAKE SURE THIS IS RIGHT "
echo "*****************************************************************"

dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST

dnl Checks for library functions.

AC_OUTPUT(Makefile rlib.pc libsrc/Makefile bindings/Makefile bindings/php/Makefile tests/Makefile)
